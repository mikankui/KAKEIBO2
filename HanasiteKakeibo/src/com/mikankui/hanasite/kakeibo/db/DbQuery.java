package com.mikankui.hanasite.kakeibo.db;import java.text.SimpleDateFormat;import java.util.Calendar;import com.mikankui.hanasite.kakeibo.GraphData;import com.mikankui.hanasite.kakeibo.InputDataCheck;import android.database.Cursor;import android.net.Uri;public class DbQuery {	private SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");	private DbAdapter dbAdapter;	public DbQuery() {		dbAdapter = new DbAdapter();	}	public int calMonth(String name, String year, String month) {		Calendar sCal = Calendar.getInstance();		Calendar eCal = Calendar.getInstance();		int syyyy = Integer.parseInt(year);		int sMM = Integer.parseInt(month) - 1;		int sdd = 1;		int shh = 0;		int smm = 0;		sCal.set(syyyy, sMM, sdd, shh, smm, 0);		int eyyyy = syyyy;		int eMM = sMM;		int edd = sCal.getActualMaximum(Calendar.DAY_OF_MONTH);		;		int ehh = 23;		int emm = 59;		eCal.set(eyyyy, eMM, edd, ehh, emm, 0);		Uri uri = Uri.parse("content://db/MEISAI");		String[] projection = { MEISAI.L_USER_NAME,				"sum(" + MEISAI.L_COST + ")" };		String selection = MEISAI.L_USER_NAME + "=? and "				+ MEISAI.L_yyyyMMddhhmm + " between ? and ? ";		String[] selectionArgs = new String[3];		String groupBy = MEISAI.L_USER_NAME;		String having = null;		String orderBy = null;		selectionArgs[0] = name;		int sum = 0;		while (sCal.before(eCal)) {			selectionArgs[1] = sdf.format(sCal.getTime());			sCal.add(Calendar.DAY_OF_MONTH, 1);			selectionArgs[2] = sdf.format(sCal.getTime());			Cursor c = dbAdapter.queryraw(uri, projection, selection,					selectionArgs, groupBy, having, orderBy);			while (c.moveToNext()) {				sum = sum + Integer.valueOf(c.getString(1));			}			c.close();		}		return sum;	}	public int calDay(String name, String year, String month, String day) {		Calendar sCal = Calendar.getInstance();		Calendar eCal = Calendar.getInstance();		int syyyy = Integer.parseInt(year);		int sMM = Integer.parseInt(month) - 1;		int sdd = Integer.parseInt(day);		int shh = 0;		int smm = 0;		int eyyyy = syyyy;		int eMM = sMM;		int edd = sdd;		int ehh = 23;		int emm = 59;		sCal.set(syyyy, sMM, sdd, shh, smm, 0);		eCal.set(eyyyy, eMM, edd, ehh, emm, 0);		Uri uri = Uri.parse("content://db/MEISAI");		String[] projection = { MEISAI.L_USER_NAME,				"sum(" + MEISAI.L_COST + ")" };		String selection = MEISAI.L_USER_NAME + "=? and "				+ MEISAI.L_yyyyMMddhhmm + " between ? and ? ";		String[] selectionArgs = { name, sdf.format(sCal.getTime()),				sdf.format(eCal.getTime()) };		String groupBy = MEISAI.L_USER_NAME;		String having = null;		String orderBy = null;		int sum = 0;		Cursor c = dbAdapter.queryraw(uri, projection, selection,				selectionArgs, groupBy, having, orderBy);		while (c.moveToNext()) {			sum = sum + Integer.valueOf(c.getString(1));		}		c.close();		return sum;	}}